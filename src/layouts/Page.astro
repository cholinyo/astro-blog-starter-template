---
import BaseHead from '../components/BaseHead.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';

interface Props {
  title: string;
  description: string;
  image?: string;
  breadcrumbs?: { label: string; href?: string }[];
}

const { title, description, image, breadcrumbs } = Astro.props;

const breadcrumbSchema = breadcrumbs
  ? {
      "@context": "https://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement": breadcrumbs.map((crumb, index) => ({
        "@type": "ListItem",
        "position": index + 1,
        "name": crumb.label,
        ...(crumb.href ? { "item": new URL(crumb.href, Astro.site).toString() } : {}),
      })),
    }
  : null;
---

<!doctype html>
<html lang="es">
  <head>
    <BaseHead title={title} description={description} image={image} noLocalSchema={false} />
    {breadcrumbSchema && (
      <script type="application/ld+json" set:html={JSON.stringify(breadcrumbSchema)} />
    )}
  </head>
  <body>
    <Header />
    {breadcrumbs && (
      <nav class="breadcrumb-nav" aria-label="Ruta de navegaciÃ³n">
        <div class="breadcrumb-inner">
          {breadcrumbs.map((crumb, i) => (
            <>
              {i > 0 && <span class="breadcrumb-sep" aria-hidden="true">/</span>}
              {crumb.href && i < breadcrumbs.length - 1
                ? <a href={crumb.href}>{crumb.label}</a>
                : <span aria-current={i === breadcrumbs.length - 1 ? 'page' : undefined}>{crumb.label}</span>
              }
            </>
          ))}
        </div>
      </nav>
    )}
    <slot />
    <Footer />
  </body>
</html>

<style>
  .breadcrumb-nav {
    background: #f8fafc;
    border-bottom: 1px solid #e5e7eb;
    padding: 0.75em 1.5em;
  }

  .breadcrumb-inner {
    display: flex;
    align-items: center;
    gap: 0.5em;
    max-width: 1100px;
    margin: 0 auto;
    font-size: 0.875rem;
    color: #6b7280;
    flex-wrap: wrap;
  }

  .breadcrumb-inner a {
    color: #1a56db;
    text-decoration: none;
  }

  .breadcrumb-inner a:hover {
    text-decoration: underline;
  }

  .breadcrumb-inner span[aria-current="page"] {
    color: #374151;
    font-weight: 600;
  }

  .breadcrumb-sep {
    color: #d1d5db;
  }
</style>
